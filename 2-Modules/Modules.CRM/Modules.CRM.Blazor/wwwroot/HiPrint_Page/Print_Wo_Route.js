//**注意：一定要使用export
export function init_hiprint() {
    if (document.readyState == 'complete') {
        hiprint.init();
    }
}

//打印制品流动卡片
//**注意：一定要使用export
export function print_data(ApiData, printer_name) {

    //指定打印机，*** 需要启动hiprint提供的服务跳过预览
    //为后台传入用户自定义打印机做准备
    //printer_name= 'Deli DL-720C'
    //let printer = { printer: printer_name, title: '打印' }

    let printTemplateJson = { "panels": [{ "index": 0, "name": 1, "height": 297, "width": 210, "paperHeader": 49.5, "paperFooter": 780, "printElements": [{ "options": { "left": 215, "top": 22.5, "height": 19.5, "width": 189, "title": "制品流动卡片", "coordinateSync": false, "widthHeightSync": false, "fontSize": 18, "letterSpacing": 3.75, "qrCodeLevel": 0, "right": 403.9921875, "bottom": 40.9921875, "vCenter": 309.4921875, "hCenter": 31.2421875 }, "printElementType": { "title": "这是更新后的元素", "type": "text" } }, { "options": { "left": 15, "top": 50, "height": 235.5, "width": 565.5, "coordinateSync": false, "widthHeightSync": false, "tableHeaderBackground": "#FFF", "right": 580.996467590332, "bottom": 284.4928894042969, "vCenter": 298.24646759033203, "hCenter": 166.74288940429688, "columns": [[{ "width": 83.25, "title": "生产令号", "field": "", "checked": true, "columnId": "", "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 83.25, "title": "", "field": "", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "title": "工序号", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "title": "名称", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "title": "单件工时", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "title": "操作者", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "title": "班长", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "title": "检验员", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "title": "合格数", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "title": "返工(修)数", "field": "", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1, "tableQRCodeLevel": 0, "tableSummaryTitle": true, "tableSummary": "" }, { "width": 100, "title": "让步数收品数", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1, "tableQRCodeLevel": 0, "tableSummaryTitle": true, "tableSummary": "" }, { "width": 100, "title": "废品数", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1, "tableQRCodeLevel": 0, "tableSummaryTitle": true, "tableSummary": "" }, { "width": 100, "title": "日期", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1, "tableQRCodeLevel": 0, "tableSummaryTitle": true, "tableSummary": "" }], [{ "width": 83.25, "title": "图号", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 83.25, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 83.25, "title": "产品名称", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 83.25, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 83.25, "title": "投入数量", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 83.25, "title": "", "field": "", "checked": true, "columnId": "", "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 83.25, "title": "分批号", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 83.25, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 83.25, "title": "材料及规格", "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 83.25, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 100, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 57.71551761456658, "title": "计调人员", "field": "", "checked": true, "columnId": "", "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 21.017425000000006, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 35.027275512525904, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.05324999999999, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 24.020058801206154, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 41.495053684152, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 84.97370398196844, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 61.35552101185268, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 57.67821233587456, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 44.301940273601936, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.644999586358956, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 27.181686273228244, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 36.0353559246646, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 59.83448363859545, "title": "备注", "field": "", "checked": true, "columnId": "", "fixed": false, "rowspan": 4, "colspan": 1 }, { "width": 54.38792102610557, "checked": true, "fixed": false, "rowspan": 4, "colspan": 1 }, { "width": 35.027275512525904, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.05324999999999, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 24.020058801206154, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 41.495053684152, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 84.97370398196844, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 61.35552101185268, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 57.67821233587456, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 44.301940273601936, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.644999586358956, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 27.181686273228244, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 36.0353559246646, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 35.027275512525904, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.05324999999999, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 24.020058801206154, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 41.495053684152, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 84.97370398196844, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 61.35552101185268, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 57.67821233587456, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 44.301940273601936, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.644999586358956, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 27.181686273228244, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 36.0353559246646, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 35.027275512525904, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.05324999999999, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 24.020058801206154, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 41.495053684152, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 84.97370398196844, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 61.35552101185268, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 57.67821233587456, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 44.301940273601936, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.644999586358956, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 27.181686273228244, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 36.0353559246646, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }], [{ "width": 39.663946761162485, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 66.9925, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 33.13853502430836, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 43.063838686962754, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 41.054311352986204, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 41.07512602665889, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 35.79580873486435, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 40.286190565347155, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 40.05609712953244, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 32.79288400148779, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }, { "width": 37.35835705198848, "checked": true, "fixed": false, "rowspan": 1, "colspan": 1 }]] }, "printElementType": { "title": "空白表格", "type": "table", "editable": true, "columnDisplayEditable": true, "columnDisplayIndexEditable": true, "columnTitleEditable": true, "columnResizable": true, "columnAlignEditable": true, "isEnableEditField": true, "isEnableContextMenu": true, "isEnableInsertRow": true, "isEnableDeleteRow": true, "isEnableInsertColumn": true, "isEnableDeleteColumn": true, "isEnableMergeCell": true } }], "paperNumberLeft": 565.5, "paperNumberTop": 819, "paperNumberContinue": true, "watermarkOptions": { "content": "vue-plugin-hiprint", "rotate": 25, "timestamp": true, "format": "YYYY-MM-DD HH:mm" } }] };
    let hiprintTemplate = new hiprint.PrintTemplate({
        template: printTemplateJson
    });

    //处理数据
    let printData = JSON.parse(ApiData)

    //增加数量汉字
    //printData.forEach(s => s.STOCK_ADD_QUANTITY = "数量：" + s.STOCK_ADD_QUANTITY); 

    if (typeof printer_name === 'undefined' || printer_name == null || printer_name === '') {
        hiprintTemplate.print(printData);
    } else {
        //print2可跳过预览
        hiprintTemplate.print2(printData, printer);
    }
}